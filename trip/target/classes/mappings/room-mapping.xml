<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="RoomDAO">
	
	<!-- 숙소 등록 -->
	<insert id="insertRoom">
		INSERT INTO ROOM(ROOM_NAME, ROOM_ADDR, ROOM_ADDR_DETAIL, ROOM_DESC, HOST_ID, ROOM_PRICE, ROOM_IMG_NO1, ROOM_IMG_NO2, ROOM_IMG_NO3, ROOM_IMG_NO4, ROOM_IMG_NO5, ROOM_POINTS, ROOM_MAX, ROOM_THEME, ROOM_CAT, ROOM_WIFI, ROOM_PET, ROOM_MEAL, ROOM_PARKING, ROOM_SWPOOL,
		ROOM_LIKES, ROOM_STARS) VALUES(#{room_name}, #{room_addr}, #{room_addr_detail}, #{room_desc}, #{host_id}, #{room_price}, #{room_img_no1}, #{room_img_no2}, #{room_img_no3}, #{room_img_no4}, #{room_img_no5}, #{room_points}, #{room_max},
		#{room_theme}, #{room_cat}, #{room_wifi}, #{room_pet}, #{room_meal}, #{room_parking}, #{room_swpool},
		#{room_likes}, #{room_stars});
	</insert>
	
	<!-- 숙소 아이디와 업주 호스트 아이디 모두가 일치하는 경우 숙소 수정 -->
	<update id="updateRoom">
		UPDATE ROOM SET
		ROOM_NAME=#{room_name}, ROOM_ADDR=#{room_addr}, ROOM_ADDR_DETAIL=#{room_addr_detail}, ROOM_DESC=#{room_desc}, ROOM_PRICE=#{room_price}, ROOM_IMG_NO1=#{room_img_no1}, ROOM_IMG_NO2=#{room_img_no2}, ROOM_IMG_NO3=#{room_img_no3}, ROOM_IMG_NO4=#{room_img_no4}, ROOM_IMG_NO5=#{room_img_no5}, ROOM_IMG_NO5=#{room_img_no5}, ROOM_POINTS=#{room_points}, ROOM_MAX=#{room_max},
		ROOM_THEME=#{room_theme}, ROOM_CAT=#{room_cat}, ROOM_WIFI=#{room_wifi}, ROOM_PET=#{room_pet}, ROOM_MEAL=#{room_meal}, ROOM_PARKING=#{room_parking},
		ROOM_SWPOOL=#{room_swpool} WHERE ROOM_ID=#{room_id} and HOST_ID=#{host_id}
	</update>
	
	<!-- 숙소 아이디와 업주 호스트 아이디 일치할때 숙소 데이터 삭제 -->
	<delete id="deleteRoom">
		DELETE FROM ROOM WHERE ROOM_ID=#{room_id} and HOST_ID=#{host_id}
	</delete>
	
	<!-- 숙소 아이디와 업주 호스트 아이디 일치하는 숙소 데이터 한 줄 끌어오기 -->
	<select id="getRoom" resultType="room">
		SELECT * FROM ROOM WHERE ROOM_ID=#{room_id}
	</select>
	
	<!-- 상세 검색 조건으로 지정한 숙소 이름, 숙소 최저 가격과 최고 가격 사이, 최대 수용 인원, 
	숙소 주변 환경 (산/바다/산과 바다), 숙소 카테고리(호텔/모텔/게스트 하우스등), 숙소 무료 와이파이 여부, 숙소 애완견 투숙 가능 여부,
	숙소 조식 포함 여부, 숙소 주차 가능 여부, 숙소 수영장 보유 여부에 따라 숙소 목록 전체 조회
	-->
	<select id="getRoomList" resultType="room">
		SELECT * FROM ROOM WHERE 1=1
			<if test='host_id != null'>AND HOST_ID = #{host_id}</if>
<!-- 		<if test='searchRoomName != null'>AND ROOM_NAME LIKE CONCAT('%',#{searchRoomName},'%')</if> -->
<!-- 		<if test='searchRoomAddr != null'>AND ROOM_ADDR LIKE CONCAT('%',#{searchRoomAddr},'%')</if> -->
<!-- 		<if test='searchRoomMinPrice != null and searchRoomMaxPrice != null'>AND ROOM_PRICE BETWEEN #{searchRoomMinPrice} and #{searchRoomMaxPrice}</if> -->
<!-- 		<if test='searchRoomMax != null'>AND ROOM_MAX &lt;= #{searchRoomMax}</if> -->
<!-- 		<if test='searchRoomTheme == "mountain" or searchRoomTheme == "sea" or searchRoomTheme == "mountainSea"'>AND ROOM_CAT LIKE CONCAT('%',#{searchRoomTheme},'%')</if> -->
<!-- 		<if test='searchRoomCat != null'>AND ROOM_CAT = #{searchRoomCat}</if> -->
<!-- 		<if test='searchRoomWIFI == "Y"'>AND ROOM_WIFI = 'Y'</if> -->
<!-- 		<if test='searchRoomPet == "Y"'>AND ROOM_PET = 'Y'</if> -->
<!-- 		<if test='searchRoomMeal == "Y"'>AND ROOM_MEAL = 'Y'</if> -->
<!-- 		<if test='searchRoomParking == "Y"'>AND ROOM_PARKING = 'Y'</if> -->
<!-- 		<if test='searchRoomSwpool == "Y"'>AND ROOM_SWPOOL = 'Y'</if> -->
<!-- 		ORDER BY SEQ DESC  -->
<!-- 		LIMIT 10 OFFSET #{offset} -->
	</select>
	
	<!-- 상세 검색에 따른 숙소 전체 갯수 조회 -->
	
	<select id="totalRoomListCnt" resultType="_int">
		SELECT COUNT(*) FROM ROOM WHERE 1=1
			<if test='host_id != null'>AND HOST_ID = #{host_id}</if>
<!-- 		<if test='searchRoomName != null'>AND ROOM_NAME LIKE CONCAT('%',#{searchRoomName},'%')</if> -->
<!-- 		<if test='searchRoomAddr != null'>AND ROOM_ADDR LIKE CONCAT('%',#{searchRoomAddr},'%')</if> -->
<!-- 		<if test='searchRoomMinPrice != null and searchRoomMaxPrice != null'>AND ROOM_PRICE BETWEEN #{searchRoomMinPrice} and #{searchRoomMaxPrice}</if> -->
<!-- 		<if test='searchRoomMax != null'>AND ROOM_MAX &lt;= #{searchRoomMax}</if> -->
<!-- 		<if test='searchRoomTheme == "mountain" or searchRoomTheme == "sea" or searchRoomTheme == "mountainSea"'>AND ROOM_CAT LIKE CONCAT('%',#{searchRoomTheme},'%')</if> -->
<!-- 		<if test='searchRoomCat != null'>AND ROOM_CAT = #{searchRoomCat}</if> -->
<!-- 		<if test='searchRoomWIFI == "Y"'>AND ROOM_WIFI = 'Y'</if> -->
<!-- 		<if test='searchRoomPet == "Y"'>AND ROOM_PET = 'Y'</if> -->
<!-- 		<if test='searchRoomMeal == "Y"'>AND ROOM_MEAL = 'Y'</if> -->
<!-- 		<if test='searchRoomParking == "Y"'>AND ROOM_PARKING = 'Y'</if> -->
<!-- 		<if test='searchRoomSwpool == "Y"'>AND ROOM_SWPOOL = 'Y'</if> -->
	</select>
	
	<!-- 장승연 전체검색 -->
	<select id="ugetRoomList" resultType="room">
		SELECT * FROM ROOM WHERE 1=1
		<if test="room_name !=null and room_name !=''"> AND ROOM_NAME LIKE CONCAT('%',#{room_name},'%') </if>
		<if test="room_addr !=null  and room_addr !=''"> AND ROOM_ADDR LIKE CONCAT('%',#{room_addr},'%') </if>
		<if test="room_cat !=null and room_cat != ''"> AND ROOM_CAT =#{room_cat} </if>
		<if test="room_min_price != null and room_max_price != null and room_min_price != '' and room_max_price != ''"> AND ROOM_PRICE BETWEEN #{room_min_price} AND #{room_max_price}
		</if>
		<if test="room_max !=null and room_max != ''"> AND ROOM_MAX =#{room_max} </if>
		<if test='room_wifi == "Y"'> AND room_wifi = #{room_wifi} </if>
		<if test='room_pet == "Y"'> AND room_pet = #{room_pet} </if>
		<if test='room_parking == "Y"'> AND room_parking = #{room_parking} </if>
		<if test='room_swpool == "Y"'> AND room_swpool = #{room_swpool} </if>
        <if test="room_theme_m !=null and room_theme_m !=''"> AND room_theme  = #{room_theme_m} </if>
        <if test="room_theme_s !=null and room_theme_s !=''"> AND room_theme  = #{room_theme_s} </if>
        <if test="room_theme_f !=null and room_theme_f !=''"> AND room_theme  = #{room_theme_f} </if>
        <if test="room_theme_v !=null and room_theme_v !=''"> AND room_theme  = #{room_theme_v} </if>
        <if test="room_theme_r !=null and room_theme_r !=''"> AND room_theme  = #{room_theme_r} </if>
        <if test="room_theme_c !=null and room_theme_c !=''"> AND room_theme  = #{room_theme_c} </if>
	</select>
	
</mapper>
